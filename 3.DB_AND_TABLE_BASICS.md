# Database and Table Basics

## SQL Command Categories

### Database Commands
Used to manage the database structure itself.
- `CREATE DATABASE`: For creating a new database.
- `DROP DATABASE`: For deleting a database.
- `USE`: To select a database for use.

### Table Commands
Used to manage the structure and data within tables.
- `CREATE TABLE`: To define a new table.
- `ALTER TABLE`: To modify an existing table structure.
- `DROP TABLE`: To remove a table.

---

## Keys in SQL

| Key Type | Description |
| :--- | :--- |
| **Primary Key** | Uniquely identifies each record in a table. It cannot be NULL. |
| **Foreign Key** | A field that provides a link between data in two tables. It points to a Primary Key in another table. |
| **Composite Primary Key** | A Primary Key that consists of two or more columns to ensure uniqueness. |

---

## SQL Constraints

Constraints are used to specify rules for the data in a table.

1.  **AUTO INCREMENT**: Automatically generates a unique number for each new record (usually used for Primary Keys).
2.  **NOT NULL**: Ensures that a column cannot have a NULL value (e.g., email usually must be present).
3.  **UNIQUE**: Ensures that all values in a column are distinct.
4.  **CHECK**: Enforces specific conditions on values.
    *   *Example:* `CONSTRAINT "age_check" CHECK (age >= 18 AND age <= 30)`
5.  **DEFAULT**: Sets a default value for a column if no value is specified.

---

## Understanding Empty Values

| Type | Description |
| :--- | :--- |
| **NULL** | Represents "no value" or unknown data. It is not the same as zero or an empty string. |
| **0** | A numeric value representing the number zero. |
| **EMPTY STRING** | Represented as `''`. It is a string with a length of zero. |

---

## DDL vs. DML

| Category | Full Name | Purpose | Statements |
| :--- | :--- | :--- | :--- |
| **DDL** | Data Definition Language | Changes the **Schema** (structure) of the database. | `CREATE`, `ALTER`, `DROP`, `TRUNCATE` |
| **DML** | Data Manipulation Language | Manages the **Data** inside the tables. | `INSERT`, `UPDATE`, `DELETE`, `SELECT` |

---

## Query Lifecycle

When you run a SQL query, it goes through these stages:

1.  **Parse**: The database checks the query for syntax and permission errors.
2.  **Plan**: The optimizer analyzes how to retrieve data. It checks **Pages** (blocks of data containing rows), decides which pages to transfer from disk to RAM, and picks the most efficient path.
3.  **Execution**: The query is actually executed, and results are returned.

---

## Indexing in Databases

Indexing is used to speed up data retrieval.

*   **Mechanism**: Usually implemented using **B+ Trees**.
*   **Columns**: Can be applied to one or more columns.
*   **Trade-off**: While indexing makes searching **faster**, it increases storage (**memory**) and can make `INSERT` operations **slower** because the index must be updated.

### Indexing Commands:
```sql
-- Create an index on a specific column
CREATE INDEX idx_email ON users(email);

-- Show existing indexes for a table
SHOW INDEX FROM users;

-- Delete an index
DROP INDEX idx_email ON users;
```

---

## Practical SQL Commands

### 1. Database Operations
```sql
-- View all existing databases
SHOW DATABASES;

-- Create a new database securely
CREATE DATABASE IF NOT EXISTS tuf_sql;

-- Create another database (standard)
CREATE DATABASE tuf_sql2;

-- Select a database to work with
USE tuf_sql;

-- Delete a database
DROP DATABASE tuf_sql2;
```

### 2. Basic Table Operations
```sql
-- Create a table with basic data types
CREATE TABLE IF NOT EXISTS users (
  user_id INT,
  name VARCHAR(30),
  email VARCHAR(50),
  is_active BOOLEAN,
  account_balance DECIMAL(10, 2),
  signup_datetime DATETIME,
  last_seen DATETIME
);

-- List all tables in the current database
SHOW TABLES;

-- Delete a table
DROP TABLE users;
```

### 3. Data Manipulation (DML)
```sql
-- Insert a single record
INSERT INTO users (user_id, name, email)
VALUES (1, "Sri", "sri39@gmail.com");

-- Insert multiple records at once
INSERT INTO users (user_id, name, email)
VALUES
  (2, 'Mark', 'mark@gmail.com'),
  (3, 'Albert', 'albert@gmail.com'),
  (4, 'Peter', 'peter@gmail.com');

-- Retrieve all data
SELECT * FROM users;

-- Retrieve specific columns with aliases
SELECT name, email AS email_id FROM users;

-- Delete specific records using a list (IN clause)
DELETE FROM users WHERE user_id IN (3, 4);
```

### 4. Advanced Table Modifications
```sql
-- Add a Primary Key to an existing table
ALTER TABLE users
ADD CONSTRAINT pk_users PRIMARY KEY (user_id);

-- Create a table with a Foreign Key relationship
CREATE TABLE orders (
  order_id INT PRIMARY KEY,
  user_id INT,
  amount DECIMAL(10, 2),
  order_date DATE,
  FOREIGN KEY (user_id) REFERENCES users(user_id)
);

-- Retrieve data from the child table
SELECT * FROM orders;
```

### 5. Table Evolution with Constraints
Here is how the `users` table evolves as we add more rules (constraints):

```sql
-- Step 1: Basic table with Primary Key and Auto-Increment
CREATE TABLE users (
  user_id INT PRIMARY KEY AUTO_INCREMENT,
  name VARCHAR(30),
  email VARCHAR(50)
);

-- Step 2: Adding NOT NULL constraint to email
CREATE TABLE users (
  user_id INT PRIMARY KEY AUTO_INCREMENT,
  name VARCHAR(30),
  email VARCHAR(50) NOT NULL
);

-- Step 3: Adding UNIQUE constraint to email
CREATE TABLE users (
  user_id INT PRIMARY KEY AUTO_INCREMENT,
  name VARCHAR(30),
  email VARCHAR(50) NOT NULL UNIQUE
);

-- Step 4: Adding a CHECK constraint for age
CREATE TABLE users (
  user_id INT PRIMARY KEY AUTO_INCREMENT,
  name VARCHAR(30),
  email VARCHAR(50) NOT NULL UNIQUE,
  age INT,
  CONSTRAINT age_check CHECK (age >= 15 AND age <= 30)
);

-- Step 5: Comprehensive Example with DEFAULT value
CREATE TABLE users (
  user_id INT PRIMARY KEY AUTO_INCREMENT,
  name VARCHAR(30),
  email VARCHAR(50) NOT NULL UNIQUE,
  age INT,
  is_active BOOLEAN DEFAULT TRUE,
  CONSTRAINT age_check CHECK (age >= 15 AND age <= 30)
);
```
