# Data Summarization in SQL

This document covers how to summarize and group data in SQL using aggregate functions and constraints.

## Key Concepts

- **GROUP BY**: Groups rows that have the same values into summary rows.
- **MIN()**: Returns the smallest value in a column.
- **MAX()**: Returns the largest value in a column.
- **SUM()**: Returns the sum of a numeric column.
- **AVG()**: Returns the average value of a numeric column.
- **HAVING**: Filters groups after aggregation (similar to WHERE but for aggregated data).
- **COUNT()**: Returns the number of rows that match a specified criterion.
  - `COUNT(*)`: Counts the total number of rows, regardless of null values.
  - `COUNT(column_name)`: Counts the number of non-null values in a column.
  - `COUNT(DISTINCT column_name)`: Counts the distinct number of values in a column (removes duplicates).

---

## Logical Execution Order in SQL
Understanding the order of execution is crucial when using groups and aggregations:
1. **FROM**: Pick the table.
2. **WHERE**: Filter rows before grouping.
3. **GROUP BY**: Make groups.
4. **Aggregate Functions**: Apply functions (SUM, AVG, COUNT, etc.).
5. **HAVING**: Filter groups after aggregation.
6. **SELECT**: Final projection.
7. **ORDER BY**: Final sort.

---

## 1. Grouping and Basic Aggregation

### Database Setup

```sql
CREATE DATABASE IF NOT EXISTS summarization_db;
USE summarization_db;

CREATE TABLE IF NOT EXISTS employees (
  emp_id           INT PRIMARY KEY,
  employee_name    VARCHAR(50) NOT NULL,
  project          VARCHAR(20) NOT NULL,
  years_experience DECIMAL(4,1) NULL,
  hours_logged     INT NULL,
  role             VARCHAR(20) NULL, 
  INDEX idx_project (project)
);

INSERT INTO employees (emp_id, employee_name, project, years_experience, hours_logged, role) VALUES
(1,  'Alice', 'Alpha', 3.0, 100, 'Developer'),
(2,  'Bob',   'Alpha', 5.0, 120, 'QA'),
(3,  'Carol', 'Alpha', 7.0, 105, 'Developer'),
(4,  'Dave',  'Alpha', NULL, 0, 'Manager'),
(5,  'Eve',   'Beta',  2.0,  80, 'Manager'),
(6,  'Frank', 'Beta',  3.0, 110, 'Developer'),
(7,  'Grace', 'Beta',  4.0, 130, 'Developer'),
(8,  'Hank',  'Beta',  3.0, NULL, 'Developer'),
(9,  'Heidi', 'Gamma', 5.0, 150, 'Developer'),
(10, 'Ivan',  'Gamma', 6.0, 140, 'QA');
```

### Usage Examples

#### GROUP BY
Select unique columns by grouping.

```sql
SELECT project FROM employees GROUP BY project;
```

#### MIN and MAX
Select the minimum and maximum value from a column.

```sql
SELECT project, MIN(years_experience) as min_exp, MAX(years_experience) as max_exp 
FROM employees 
GROUP BY project;
```

#### SUM and AVG
Select the sum and average value from a column.

```sql
SELECT project, AVG(years_experience) as avg_exp, SUM(hours_logged) as total_hours 
FROM employees 
GROUP BY project;
```

#### HAVING
Filter groups after aggregation.

```sql
SELECT project, AVG(years_experience) as avg_exp, SUM(hours_logged) as total_hours 
FROM employees 
GROUP BY project 
HAVING total_hours > 300;
```

---

## 2. Using COUNT

### Database Setup

```sql
CREATE TABLE IF NOT EXISTS registrations (
  reg_id      INT PRIMARY KEY,
  user_name   VARCHAR(50) NULL,
  email       VARCHAR(120) NULL,
  event       VARCHAR(50) NOT NULL,
  ticket_type ENUM('Free','Paid') NOT NULL,
  referrer    VARCHAR(50) NULL,
  INDEX idx_event (event)
);

INSERT INTO registrations (reg_id, user_name, email, event, ticket_type, referrer) VALUES
(1,  'Aisha',  'aisha@example.com',   'TechFest',  'Paid', 'Instagram'),
(2,  'Rohan',  'rohan@example.com',   'TechFest',  'Free', NULL),
(3,  'Aisha',  'aisha@example.com',   'CodeCamp',  'Paid', 'Instagram'),
(4,  'Mohit',  NULL,                  'TechFest',  'Free', 'LinkedIn'),
(5,  'Neha',   'neha@example.com',    'CodeCamp',  'Free', 'Instagram'),
(6,  NULL,     'unknown@example.com', 'DesignCon', 'Paid', 'Twitter'),
(7,  'Aisha',  'aisha@example.com',   'TechFest',  'Paid', 'Instagram'),
(8,  'Vishal', NULL,                  'DesignCon', 'Free', NULL),
(9,  'Rohan',  'rohan@example.com',   'TechFest',  'Free', 'Instagram'),
(10, 'Aisha',  'aisha@example.com',   'CodeCamp',  'Paid', NULL);
```

### Usage Examples

#### COUNT(*)
Count the number of rows regardless of null values.

```sql
SELECT COUNT(*) FROM registrations;
```

#### COUNT(column_name)
Skip null values in a column.

```sql
SELECT COUNT(email) FROM registrations;
```

#### COUNT(DISTINCT column_name)
Count the distinct number of values in a column (removes duplicates).

```sql
SELECT COUNT(DISTINCT ticket_type) FROM registrations;
```

#### COUNT with GROUP BY
Count total registrations per event.

```sql
SELECT event, COUNT(*) as registrations 
FROM registrations 
GROUP BY event;
```

#### COUNT Unique with GROUP BY
Count unique registrations per event.

```sql
SELECT event, COUNT(DISTINCT user_name) as registrations 
FROM registrations 
GROUP BY event; 
```

#### Combine COUNT with GROUP BY, DISTINCT, and HAVING
Filter groups based on distinct count.

```sql
SELECT event, COUNT(DISTINCT user_name) as registrations 
FROM registrations 
GROUP BY event 
HAVING registrations > 1;
```





